# 发票合并程序

这是一个简单易用的发票合并工具，可以将多个PDF或图片格式的发票文件合并成一个PDF文件，每页放置两张发票，布局整洁美观。

## 功能特点

- 支持多种文件格式：
  - PDF文件
  - 图片文件（PNG、JPG、JPEG）
- 智能布局：
  - 每页自动放置两张发票
  - 自动保持原始比例
  - 合理的页面边距
- 便捷操作：
  - 简单的图形界面
  - 支持多选文件
  - 自动保存到下载文件夹
- 可靠性：
  - 自动错误处理
  - 详细的日志记录
  - 临时文件自动清理

## 使用方法

1. 双击 `启动程序.command` 运行程序
2. 在弹出的文件选择窗口中选择要合并的发票文件
   - 可以按住 Shift 键选择连续的多个文件
   - 可以按住 Command 键选择不连续的多个文件
3. 点击"打开"后程序会自动处理并合并文件
4. 合并后的PDF文件会自动保存到下载文件夹
   - 文件名格式：`merged_invoices_YYYYMMDD_HHMMSS.pdf`
   - 例如：`merged_invoices_20241209_225430.pdf`

## 系统要求

- macOS 操作系统
- Python 3.11 或更高版本
- 必要的依赖包（已在虚拟环境中安装）：
  - PySimpleGUI
  - Pillow (PIL)
  - PyPDF2
  - pdf2image
  - reportlab
- Poppler（用于PDF处理，通过Homebrew安装）

## 故障排除

如果遇到问题：

1. 检查 `invoice_merger.log` 文件中的错误信息
2. 确保所有文件格式正确且未损坏
3. 确保有足够的磁盘空间
4. 确保下载文件夹有写入权限

## 注意事项

- 建议每次处理适量文件，避免一次性处理太多
- 程序会自动调整图片大小以确保最佳显示效果
- 输出文件会自动使用时间戳命名，不会覆盖已有文件
- 处理过程中会在临时目录创建文件，程序结束后会自动清理

## 技术支持

如果遇到问题或需要帮助，请：

1. 查看 `invoice_merger.log` 日志文件
2. 记录具体的错误信息
3. 描述操作步骤和问题现象
